<?php

// test suite from https://code.iamcal.com/php/rfc822/tests/
// Commented expected values are those that PHP filter_var() failed to validate/unvalidate
$emailTest = [
    ['payload' => 'first.last@iana.org', 'expected' => true],
    ['payload' => '1234567890123456789012345678901234567890123456789012345678901234@iana.org', 'expected' => true],
    ['payload' => 'first.last@sub.do,com', 'expected' => false],
    ['payload' => '"first\"last"@iana.org', 'expected' => true],
    ['payload' => 'first\@last@iana.org', 'expected' => false],
    ['payload' => '"first@last"@iana.org', 'expected' => true],
    ['payload' => '"first\\last"@iana.org', 'expected' => true],
    ['payload' => 'x@x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x2', 'expected' => true],
    ['payload' => '1234567890123456789012345678901234567890123456789012345678@12345678901234567890123456789012345678901234567890123456789.12345678901234567890123456789012345678901234567890123456789.123456789012345678901234567890123456789012345678901234567890123.iana.org', 'expected' => true],
    ['payload' => 'first.last@[12.34.56.78]', 'expected' => true],
    ['payload' => 'first.last@[IPv6:::12.34.56.78]', 'expected' => true],
    ['payload' => 'first.last@[IPv6:1111:2222:3333::4444:12.34.56.78]', 'expected' => true],
    ['payload' => 'first.last@[IPv6:1111:2222:3333:4444:5555:6666:12.34.56.78]', 'expected' => true],
    ['payload' => 'first.last@[IPv6:::1111:2222:3333:4444:5555:6666]', 'expected' => true],
    ['payload' => 'first.last@[IPv6:1111:2222:3333::4444:5555:6666]', 'expected' => true],
    ['payload' => 'first.last@[IPv6:1111:2222:3333:4444:5555:6666::]', 'expected' => true],
    ['payload' => 'first.last@[IPv6:1111:2222:3333:4444:5555:6666:7777:8888]', 'expected' => true],
    ['payload' => 'first.last@x23456789012345678901234567890123456789012345678901234567890123.iana.org', 'expected' => true],
    ['payload' => 'first.last@3com.com', 'expected' => true],
    ['payload' => 'first.last@123.iana.org', 'expected' => true],
    ['payload' => '123456789012345678901234567890123456789012345678901234567890@12345678901234567890123456789012345678901234567890123456789.12345678901234567890123456789012345678901234567890123456789.12345678901234567890123456789012345678901234567890123456789.12345.iana.org', 'expected' => false],
    ['payload' => 'first.last', 'expected' => false],
    ['payload' => '12345678901234567890123456789012345678901234567890123456789012345@iana.org', 'expected' => false],
    ['payload' => '.first.last@iana.org', 'expected' => false],
    ['payload' => 'first.last.@iana.org', 'expected' => false],
    ['payload' => 'first..last@iana.org', 'expected' => false],
    ['payload' => '"first"last"@iana.org', 'expected' => false],
    ['payload' => '"first\last"@iana.org', 'expected' => true],
    ['payload' => '"""@iana.org', 'expected' => false],
    ['payload' => '"\"@iana.org', 'expected' => false],
    ['payload' => '""@iana.org', 'expected' => true], // [30] false),
    ['payload' => 'first\\@last@iana.org', 'expected' => false],
    ['payload' => 'first.last@', 'expected' => false],
    ['payload' => 'x@x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456789.x23456', 'expected' => false],
    ['payload' => 'first.last@[.12.34.56.78]', 'expected' => false],
    ['payload' => 'first.last@[12.34.56.789]', 'expected' => false],
    ['payload' => 'first.last@[::12.34.56.78]', 'expected' => false],
    ['payload' => 'first.last@[IPv5:::12.34.56.78]', 'expected' => false],
    ['payload' => 'first.last@[IPv6:1111:2222:3333::4444:5555:12.34.56.78]', 'expected' => false], // [38] true),
    ['payload' => 'first.last@[IPv6:1111:2222:3333:4444:5555:12.34.56.78]', 'expected' => false],
    ['payload' => 'first.last@[IPv6:1111:2222:3333:4444:5555:6666:7777:12.34.56.78]', 'expected' => false],
    ['payload' => 'first.last@[IPv6:1111:2222:3333:4444:5555:6666:7777]', 'expected' => false],
    ['payload' => 'first.last@[IPv6:1111:2222:3333:4444:5555:6666:7777:8888:9999]', 'expected' => false],
    ['payload' => 'first.last@[IPv6:1111:2222::3333::4444:5555:6666]', 'expected' => false],
    ['payload' => 'first.last@[IPv6:1111:2222:3333::4444:5555:6666:7777]', 'expected' => false], // [44] true),
    ['payload' => 'first.last@[IPv6:1111:2222:333x::4444:5555]', 'expected' => false],
    ['payload' => 'first.last@[IPv6:1111:2222:33333::4444:5555]', 'expected' => false],
    ['payload' => 'first.last@example.123', 'expected' => false], // [47] true),
    ['payload' => 'first.last@com', 'expected' => false], // [48] true),
    ['payload' => 'first.last@-xample.com', 'expected' => false],
    ['payload' => 'first.last@exampl-.com', 'expected' => false],
    ['payload' => 'first.last@x234567890123456789012345678901234567890123456789012345678901234.iana.org', 'expected' => false],
    ['payload' => '"Abc\@def"@iana.org', 'expected' => true],
    ['payload' => '"Fred\ Bloggs"@iana.org', 'expected' => true],
    ['payload' => '"Joe.\\Blow"@iana.org', 'expected' => true],
    ['payload' => '"Abc@def"@iana.org', 'expected' => true],
    ['payload' => '"Fred Bloggs"@iana.org', 'expected' => false], // [56] true),
    ['payload' => 'user+mailbox@iana.org', 'expected' => true],
    ['payload' => 'customer/department=shipping@iana.org', 'expected' => true],
    ['payload' => '$A12345@iana.org', 'expected' => true],
    ['payload' => '!def!xyz%abc@iana.org', 'expected' => true],
    ['payload' => '_somename@iana.org', 'expected' => true],
    ['payload' => 'dclo@us.ibm.com', 'expected' => true],
    ['payload' => 'abc\@def@iana.org', 'expected' => false],
    ['payload' => 'abc\\@iana.org', 'expected' => false],
    ['payload' => 'peter.piper@iana.org', 'expected' => true],
    ['payload' => 'Doug\ \"Ace\"\ Lovell@iana.org', 'expected' => false],
    ['payload' => '"Doug \"Ace\" L."@iana.org', 'expected' => false], // [67] true),
    ['payload' => 'abc@def@iana.org', 'expected' => false],
    ['payload' => 'abc\\@def@iana.org', 'expected' => false],
    ['payload' => 'abc\@iana.org', 'expected' => false],
    ['payload' => '@iana.org', 'expected' => false],
    ['payload' => 'doug@', 'expected' => false],
    ['payload' => '"qu@iana.org', 'expected' => false],
    ['payload' => 'ote"@iana.org', 'expected' => false],
    ['payload' => '.dot@iana.org', 'expected' => false],
    ['payload' => 'dot.@iana.org', 'expected' => false],
    ['payload' => 'two..dot@iana.org', 'expected' => false],
    ['payload' => '"Doug "Ace" L."@iana.org', 'expected' => false],
    ['payload' => 'Doug\ \"Ace\"\ L\.@iana.org', 'expected' => false],
    ['payload' => 'hello world@iana.org', 'expected' => false],
    ['payload' => 'gatsby@f.sc.ot.t.f.i.tzg.era.l.d.', 'expected' => false],
    ['payload' => 'test@iana.org', 'expected' => true],
    ['payload' => 'TEST@iana.org', 'expected' => true],
    ['payload' => '1234567890@iana.org', 'expected' => true],
    ['payload' => 'test+test@iana.org', 'expected' => true],
    ['payload' => 'test-test@iana.org', 'expected' => true],
    ['payload' => 't*est@iana.org', 'expected' => true],
    ['payload' => '+1~1+@iana.org', 'expected' => true],
    ['payload' => '{_test_}@iana.org', 'expected' => true],
    ['payload' => '"[[ test ]]"@iana.org', 'expected' => false], // [90] true),
    ['payload' => 'test.test@iana.org', 'expected' => true],
    ['payload' => '"test.test"@iana.org', 'expected' => true],
    ['payload' => 'test."test"@iana.org', 'expected' => true],
    ['payload' => '"test@test"@iana.org', 'expected' => true],
    ['payload' => 'test@123.123.123.x123', 'expected' => true],
    ['payload' => 'test@123.123.123.123', 'expected' => false], // [96] true),
    ['payload' => 'test@[123.123.123.123]', 'expected' => true],
    ['payload' => 'test@example.iana.org', 'expected' => true],
    ['payload' => 'test@example.example.iana.org', 'expected' => true],
    ['payload' => 'test.iana.org', 'expected' => false],
    ['payload' => 'test.@iana.org', 'expected' => false],
    ['payload' => 'test..test@iana.org', 'expected' => false],
    ['payload' => '.test@iana.org', 'expected' => false],
    ['payload' => 'test@test@iana.org', 'expected' => false],
    ['payload' => 'test@@iana.org', 'expected' => false],
    ['payload' => '-- test --@iana.org', 'expected' => false],
    ['payload' => '[test]@iana.org', 'expected' => false],
    ['payload' => '"test\test"@iana.org', 'expected' => true],
    ['payload' => '"test"test"@iana.org', 'expected' => false],
    ['payload' => '()[]\;:,><@iana.org', 'expected' => false],
    ['payload' => 'test@.', 'expected' => false],
    ['payload' => 'test@example.', 'expected' => false],
    ['payload' => 'test@.org', 'expected' => false],
    ['payload' => 'test@123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012.com', 'expected' => false],
    ['payload' => 'test@example', 'expected' => false], // [115] true),
    ['payload' => 'test@[123.123.123.123', 'expected' => false],
    ['payload' => 'test@123.123.123.123]', 'expected' => false],
    ['payload' => 'NotAnEmail', 'expected' => false],
    ['payload' => '@NotAnEmail', 'expected' => false],
    ['payload' => '"test\\blah"@iana.org', 'expected' => true],
    ['payload' => '"test\blah"@iana.org', 'expected' => true],
    ['payload' => '"test\&#13;blah"@iana.org', 'expected' => true],
    ['payload' => '"test&#13;blah"@iana.org', 'expected' => true], // [123] false),
    ['payload' => '"test\"blah"@iana.org', 'expected' => true],
    ['payload' => '"test"blah"@iana.org', 'expected' => false],
    ['payload' => 'customer/department@iana.org', 'expected' => true],
    ['payload' => '_Yosemite.Sam@iana.org', 'expected' => true],
    ['payload' => '~@iana.org', 'expected' => true],
    ['payload' => '.wooly@iana.org', 'expected' => false],
    ['payload' => 'wo..oly@iana.org', 'expected' => false],
    ['payload' => 'pootietang.@iana.org', 'expected' => false],
    ['payload' => '.@iana.org', 'expected' => false],
    ['payload' => '"Austin@Powers"@iana.org', 'expected' => true],
    ['payload' => 'Ima.Fool@iana.org', 'expected' => true],
    ['payload' => '"Ima.Fool"@iana.org', 'expected' => true],
    ['payload' => '"Ima Fool"@iana.org', 'expected' => false], // [136] true),
    ['payload' => 'Ima Fool@iana.org', 'expected' => false],
    ['payload' => 'phil.h\@\@ck@haacked.com', 'expected' => false],
    ['payload' => '"first"."last"@iana.org', 'expected' => true],
    ['payload' => '"first".middle."last"@iana.org', 'expected' => true],
    ['payload' => '"first\\"last"@iana.org', 'expected' => true], // [141] false),
    ['payload' => '"first".last@iana.org', 'expected' => true],
    ['payload' => 'first."last"@iana.org', 'expected' => true],
    ['payload' => '"first"."middle"."last"@iana.org', 'expected' => true],
    ['payload' => '"first.middle"."last"@iana.org', 'expected' => true],
    ['payload' => '"first.middle.last"@iana.org', 'expected' => true],
    ['payload' => '"first..last"@iana.org', 'expected' => true],
    ['payload' => 'foo@[\1.2.3.4]', 'expected' => false],
    ['payload' => '"first\\\"last"@iana.org', 'expected' => false], // [149] true),
    ['payload' => 'first."mid\dle"."last"@iana.org', 'expected' => true],
    ['payload' => 'Test.&#13;&#10; Folding.&#13;&#10; Whitespace@iana.org', 'expected' => false], // [151] true),
    ['payload' => 'first."".last@iana.org', 'expected' => true], // [152] false),
    ['payload' => 'first\last@iana.org', 'expected' => false],
    ['payload' => 'Abc\@def@iana.org', 'expected' => false],
    ['payload' => 'Fred\ Bloggs@iana.org', 'expected' => false],
    ['payload' => 'Joe.\\Blow@iana.org', 'expected' => false],
    ['payload' => 'first.last@[IPv6:1111:2222:3333:4444:5555:6666:12.34.567.89]', 'expected' => false],
    ['payload' => '"test\&#13;&#10; blah"@iana.org', 'expected' => false],
    ['payload' => '"test&#13;&#10; blah"@iana.org', 'expected' => false], // [159] true),
    ['payload' => '{^c\@**Dog^}@cartoon.com', 'expected' => false],
    ['payload' => '(foo)cal(bar)@(baz)iamcal.com(quux)', 'expected' => false], // [161] true),
    ['payload' => 'cal@iamcal(woo).(yay)com', 'expected' => false], // [162] true),
    ['payload' => '"foo"(yay)@(hoopla)[1.2.3.4]', 'expected' => false],
    ['payload' => 'cal(woo(yay)hoopla)@iamcal.com', 'expected' => false], // [164] true),
    ['payload' => 'cal(foo\@bar)@iamcal.com', 'expected' => false], // [165] true),
    ['payload' => 'cal(foo\)bar)@iamcal.com', 'expected' => false], // [166] true),
    ['payload' => 'cal(foo(bar)@iamcal.com', 'expected' => false],
    ['payload' => 'cal(foo)bar)@iamcal.com', 'expected' => false],
    ['payload' => 'cal(foo\)@iamcal.com', 'expected' => false],
    ['payload' => 'first().last@iana.org', 'expected' => false], // [170] true),
    ['payload' => 'first.(&#13;&#10; middle&#13;&#10; )last@iana.org', 'expected' => false], // [171] true),
    ['payload' => 'first(12345678901234567890123456789012345678901234567890)last@(1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890)iana.org', 'expected' => false],
    ['payload' => 'first(Welcome to&#13;&#10; the ("wonderful" (!)) world&#13;&#10; of email)@iana.org', 'expected' => false], // [173] true),
    ['payload' => 'pete(his account)@silly.test(his host)', 'expected' => false], // [174] true),
    ['payload' => 'c@(Chris\'s host.)public.example', 'expected' => false], // [175] true),
    ['payload' => 'jdoe@machine(comment).  example', 'expected' => false], // [176] true),
    ['payload' => '1234   @   local(blah)  .machine .example', 'expected' => false], // [177] true),
    ['payload' => 'first(middle)last@iana.org', 'expected' => false],
    ['payload' => 'first(abc.def).last@iana.org', 'expected' => false], // [179] true),
    ['payload' => 'first(a"bc.def).last@iana.org', 'expected' => false], // [180] true),
    ['payload' => 'first.(")middle.last(")@iana.org', 'expected' => false], // [181] true),
    ['payload' => 'first(abc("def".ghi).mno)middle(abc("def".ghi).mno).last@(abc("def".ghi).mno)example(abc("def".ghi).mno).(abc("def".ghi).mno)com(abc("def".ghi).mno)', 'expected' => false],
    ['payload' => 'first(abc\(def)@iana.org', 'expected' => false], // [183] true),
    ['payload' => 'first.last@x(1234567890123456789012345678901234567890123456789012345678901234567890).com', 'expected' => false], // [184] true),
    ['payload' => 'a(a(b(c)d(e(f))g)h(i)j)@iana.org', 'expected' => false], // [185] true),
    ['payload' => 'a(a(b(c)d(e(f))g)(h(i)j)@iana.org', 'expected' => false],
    ['payload' => 'name.lastname@domain.com', 'expected' => true],
    ['payload' => '.@', 'expected' => false],
    ['payload' => 'a@b', 'expected' => false], // [189] true),
    ['payload' => '@bar.com', 'expected' => false],
    ['payload' => '@@bar.com', 'expected' => false],
    ['payload' => 'a@bar.com', 'expected' => true],
    ['payload' => 'aaa.com', 'expected' => false],
    ['payload' => 'aaa@.com', 'expected' => false],
    ['payload' => 'aaa@.123', 'expected' => false],
    ['payload' => 'aaa@[123.123.123.123]', 'expected' => true],
    ['payload' => 'aaa@[123.123.123.123]a', 'expected' => false],
    ['payload' => 'aaa@[123.123.123.333]', 'expected' => false],
    ['payload' => 'a@bar.com.', 'expected' => false],
    ['payload' => 'a@bar', 'expected' => false], // [200] true),
    ['payload' => 'a-b@bar.com', 'expected' => true],
    ['payload' => '+@b.c', 'expected' => true],
    ['payload' => '+@b.com', 'expected' => true],
    ['payload' => 'a@-b.com', 'expected' => false],
    ['payload' => 'a@b-.com', 'expected' => false],
    ['payload' => '-@..com', 'expected' => false],
    ['payload' => '-@a..com', 'expected' => false],
    ['payload' => 'a@b.co-foo.uk', 'expected' => true],
    ['payload' => '"hello my name is"@stutter.com', 'expected' => false], // [209] true),
    ['payload' => '"Test \"Fail\" Ing"@iana.org', 'expected' => false], // [210] true),
    ['payload' => 'valid@about.museum', 'expected' => true],
    ['payload' => 'invalid@about.museum-', 'expected' => false],
    ['payload' => 'shaitan@my-domain.thisisminekthx', 'expected' => true],
    ['payload' => 'test@...........com', 'expected' => false],
    ['payload' => 'foobar@192.168.0.1', 'expected' => false], // [215] true),
    ['payload' => '"Joe\\Blow"@iana.org', 'expected' => true],
    ['payload' => 'Invalid \&#10; Folding \&#10; Whitespace@iana.org', 'expected' => false],
    ['payload' => 'HM2Kinsists@(that comments are allowed)this.is.ok', 'expected' => false], // [218] true),
    ['payload' => 'user%uucp!path@berkeley.edu', 'expected' => true],
    ['payload' => '"first(last)"@iana.org', 'expected' => true],
    ['payload' => ' &#13;&#10; (&#13;&#10; x &#13;&#10; ) &#13;&#10; first&#13;&#10; ( &#13;&#10; x&#13;&#10; ) &#13;&#10; .&#13;&#10; ( &#13;&#10; x) &#13;&#10; last &#13;&#10; (  x &#13;&#10; ) &#13;&#10; @iana.org', 'expected' => false], // [221] true),
    ['payload' => 'first.last @iana.org', 'expected' => false], // [222] true),
    ['payload' => 'test. &#13;&#10; &#13;&#10; obs@syntax.com', 'expected' => false], // [223] true),
    ['payload' => 'test.&#13;&#10;&#13;&#10; obs@syntax.com', 'expected' => false],
    ['payload' => '"Unicode NULL \␀"@char.com', 'expected' => false], // [225] true),
    ['payload' => '"Unicode NULL ␀"@char.com', 'expected' => false],
    ['payload' => 'Unicode NULL \␀@char.com', 'expected' => false],
    ['payload' => 'cdburgess+!#$%&\'*-/=?+_{}|~test@gmail.com', 'expected' => true],
    ['payload' => 'first.last@[IPv6:::a2:a3:a4:b1:b2:b3:b4]', 'expected' => false], // [229] true),
    ['payload' => 'first.last@[IPv6:a1:a2:a3:a4:b1:b2:b3::]', 'expected' => false], // [230] true),
    ['payload' => 'first.last@[IPv6::]', 'expected' => false],
    ['payload' => 'first.last@[IPv6:::]', 'expected' => true],
    ['payload' => 'first.last@[IPv6::::]', 'expected' => false],
    ['payload' => 'first.last@[IPv6::b4]', 'expected' => false],
    ['payload' => 'first.last@[IPv6:::b4]', 'expected' => true],
    ['payload' => 'first.last@[IPv6::::b4]', 'expected' => false],
    ['payload' => 'first.last@[IPv6::b3:b4]', 'expected' => false],
    ['payload' => 'first.last@[IPv6:::b3:b4]', 'expected' => true],
    ['payload' => 'first.last@[IPv6::::b3:b4]', 'expected' => false],
    ['payload' => 'first.last@[IPv6:a1::b4]', 'expected' => true],
    ['payload' => 'first.last@[IPv6:a1:::b4]', 'expected' => false],
    ['payload' => 'first.last@[IPv6:a1:]', 'expected' => false],
    ['payload' => 'first.last@[IPv6:a1::]', 'expected' => true],
    ['payload' => 'first.last@[IPv6:a1:::]', 'expected' => false],
    ['payload' => 'first.last@[IPv6:a1:a2:]', 'expected' => false],
    ['payload' => 'first.last@[IPv6:a1:a2::]', 'expected' => true],
    ['payload' => 'first.last@[IPv6:a1:a2:::]', 'expected' => false],
    ['payload' => 'first.last@[IPv6:0123:4567:89ab:cdef::]', 'expected' => true],
    ['payload' => 'first.last@[IPv6:0123:4567:89ab:CDEF::]', 'expected' => true],
    ['payload' => 'first.last@[IPv6:::a3:a4:b1:ffff:11.22.33.44]', 'expected' => true],
    ['payload' => 'first.last@[IPv6:::a2:a3:a4:b1:ffff:11.22.33.44]', 'expected' => false], // [251] true),
    ['payload' => 'first.last@[IPv6:a1:a2:a3:a4::11.22.33.44]', 'expected' => true],
    ['payload' => 'first.last@[IPv6:a1:a2:a3:a4:b1::11.22.33.44]', 'expected' => false], // [253] true),
    ['payload' => 'first.last@[IPv6::11.22.33.44]', 'expected' => false],
    ['payload' => 'first.last@[IPv6::::11.22.33.44]', 'expected' => false],
    ['payload' => 'first.last@[IPv6:a1:11.22.33.44]', 'expected' => false],
    ['payload' => 'first.last@[IPv6:a1::11.22.33.44]', 'expected' => true],
    ['payload' => 'first.last@[IPv6:a1:::11.22.33.44]', 'expected' => false],
    ['payload' => 'first.last@[IPv6:a1:a2::11.22.33.44]', 'expected' => true],
    ['payload' => 'first.last@[IPv6:a1:a2:::11.22.33.44]', 'expected' => false],
    ['payload' => 'first.last@[IPv6:0123:4567:89ab:cdef::11.22.33.44]', 'expected' => true],
    ['payload' => 'first.last@[IPv6:0123:4567:89ab:cdef::11.22.33.xx]', 'expected' => false],
    ['payload' => 'first.last@[IPv6:0123:4567:89ab:CDEF::11.22.33.44]', 'expected' => true],
    ['payload' => 'first.last@[IPv6:0123:4567:89ab:CDEFF::11.22.33.44]', 'expected' => false],
    ['payload' => 'first.last@[IPv6:a1::a4:b1::b4:11.22.33.44]', 'expected' => false],
    ['payload' => 'first.last@[IPv6:a1::11.22.33]', 'expected' => false],
    ['payload' => 'first.last@[IPv6:a1::11.22.33.44.55]', 'expected' => false],
    ['payload' => 'first.last@[IPv6:a1::b211.22.33.44]', 'expected' => false],
    ['payload' => 'first.last@[IPv6:a1::b2:11.22.33.44]', 'expected' => true],
    ['payload' => 'first.last@[IPv6:a1::b2::11.22.33.44]', 'expected' => false],
    ['payload' => 'first.last@[IPv6:a1::b3:]', 'expected' => false],
    ['payload' => 'first.last@[IPv6::a2::b4]', 'expected' => false],
    ['payload' => 'first.last@[IPv6:a1:a2:a3:a4:b1:b2:b3:]', 'expected' => false],
    ['payload' => 'first.last@[IPv6::a2:a3:a4:b1:b2:b3:b4]', 'expected' => false],
    ['payload' => 'first.last@[IPv6:a1:a2:a3:a4::b1:b2:b3:b4]', 'expected' => false],
    ['payload' => 'test@test.com', 'expected' => true],
    ['payload' => 'test@example.com&#10;', 'expected' => false],
    ['payload' => 'test@xn--example.com', 'expected' => true],
    ['payload' => 'test@Bücher.ch', 'expected' => false], // [279] true)
];
